"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1181,1302],{8840:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var a=n(5043),r=n(1238),i=n(2039),o=n(4964),c=n(7424),s=n(9456),l=n(3734),u=n(4235),d=n(8054),p=n(1605),f=n(5223),g=n(5618),h=n(9092),x=n(200),v=n(579);const m=function(){const{t:e}=(0,h.B)(["common"]),t=[{styles:"w-[10%] text-start",title:"\u2116"},{styles:"w-[10%] text-start",filter:"createdAt",title:e("Sana")},{styles:"w-[10%] text-start",filter:"id",title:e("ID")},{styles:"text-start",title:e("Maxsulotlar")},{styles:"w-[10%]",title:e("Holati")},{styles:"w-[10%]",title:" "}],n=(0,s.wA)(),{connectors:m,errorConnectors:y,clearErrorConnectors:D,loading:S,dataLoading:w,total:j}=(0,s.d4)((e=>e.inventoryConnectors)),[b,k]=(0,a.useState)({filter:"",sort:"",count:0}),[_,A]=(0,a.useState)(m),[z,P]=(0,a.useState)(m),[I,C]=(0,a.useState)("10"),[E,Y]=(0,a.useState)(0),[N,M]=(0,a.useState)(j),[W,F]=(0,a.useState)(new Date((new Date).getFullYear(),(new Date).getMonth(),1)),[O,U]=(0,a.useState)(new Date),[Z,q]=(0,a.useState)(null),[B,H]=(0,a.useState)(!1),L=["\u2116",e("Sana"),e("Kodi"),e("Maxsulot"),e("Narxi UZS"),e("Dastlabki"),e("Sanoq"),e("Farqi"),e("Farqi UZS")],$=(0,a.useCallback)((t=>{const n=(e=>{const t=Object.keys(e[0]),n=t.reduce(((e,t)=>e>t.length?e:t.length),0);return t.map((e=>({wch:n})))})(t),a=r.Wp.book_new(),i=r.Wp.json_to_sheet([]);i["!cols"]=n,r.Wp.sheet_add_aoa(i,[L]),r.Wp.sheet_add_json(i,t,{origin:"A2",skipHeader:!0}),r.Wp.book_append_sheet(a,i,"Inventorizatsiyalar"),r._h(a,`${e("Invertarizatsiyalar")}-${(new Date).toLocaleDateString()}.xlsx`)}),[L,e]);return(0,a.useEffect)((()=>{P(m),A(m)}),[m]),(0,a.useEffect)((()=>{y&&((0,l.lY)(y,"error"),n(D()))}),[n,D,y]),(0,a.useEffect)((()=>{const e={currentPage:E,countPage:I,startDate:new Date(new Date(W).getFullYear(),new Date(W).getMonth(),new Date(W).getDate()).toISOString(),endDate:O.toISOString()};n((0,f.$k)(e))}),[E,I,n,W,O]),(0,a.useEffect)((()=>{P(m)}),[m]),(0,a.useEffect)((()=>{M(j)}),[j]),(0,v.jsxs)(p.P.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.8,ease:[.04,.62,.23,.98]},children:[(0,v.jsx)(g.A,{printedInventories:Z,body:"checkInventory",isOpen:B,toggleModal:()=>{H(!B),q(null)}}),w&&(0,v.jsx)("div",{className:"fixed z-[50] backdrop-blur-[2px] left-0 right-0 bg-white-700 flex flex-col items-center justify-center w-full h-full",children:(0,v.jsx)(u.A,{})}),(0,v.jsxs)("div",{className:"inventoriesHead mainPadding",children:[(0,v.jsx)("div",{className:"font-[400] text-[1.25rem] text-blue-900",children:e("Inventarizatsiyalar")}),(0,v.jsx)("div",{children:0!==N&&(0,v.jsx)(o.A,{countPage:Number(I),totalDatas:N,currentPage:E,setCurrentPage:Y})})]}),(0,v.jsx)(c.A,{filterBy:["total","startDate","endDate"],filterByTotal:e=>{let{value:t}=e;C(t),Y(0)},setEndDate:U,setStartDate:F,startDate:W,endDate:O}),(0,v.jsx)("div",{className:"tableContainerPadding",children:S?(0,v.jsx)(u.A,{}):0===z.length?(0,v.jsx)(d.A,{text:"Invnentarizatsiyalar mavjud emas!"}):(0,v.jsx)(i.A,{isDisabled:w,page:"inventories",currentPage:E,countPage:I,data:z,headers:t,Excel:(e,t)=>{const a={id:e._id};n((0,f._A)(a)).then((e=>{let{payload:{inventories:n}}=e;if(n.length>0){const e=[...n].map(((e,t)=>({nth:t+1,data:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleDateString(),code:e.productdata.code,name:e.productdata.name,incomingprice:(0,x.Df)(e.price.incomingpriceuzs*e.productcount),initial:e.productcount,count:e.inventorycount,difference:e.inventorycount-e.productcount,differenceUZS:e.inventorycount*e.price.incomingpriceuzs-e.productcount*e.price.incomingpriceuzs})));e.push({nth:"",data:"",code:"",name:"",incomingprice:[...n].reduce(((e,t)=>e+(0,x.Df)(t.price.incomingpriceuzs*t.productcount)),0),initial:[...n].reduce(((e,t)=>e+t.productcount),0),count:[...n].reduce(((e,t)=>e+t.inventorycount),0),difference:[...n].reduce(((e,t)=>e+(t.inventorycount-t.productcount)),0),differenceUZS:[...n].reduce(((e,t)=>e+(t.inventorycount*t.price.incomingpriceuzs-t.productcount*t.price.incomingpriceuzs)),0)}),$(e,t)}}))},Print:e=>{const t={id:e._id};n((0,f._A)(t)).then((e=>{let{payload:{inventories:t}}=e;t.length>0&&q(t)})),H(!0)},Sort:e=>{if(e===b.filter)switch(b.count){case 1:k({filter:e,sort:"1",count:2}),(0,x.Yc)(z,P,e,1,_);break;case 2:k({filter:e,sort:"",count:0}),(0,x.Yc)(z,P,e,"",_);break;default:k({filter:e,sort:"-1",count:1}),(0,x.Yc)(z,P,e,-1,_)}else k({filter:e,sort:"-1",count:1}),(0,x.Yc)(z,P,e,-1,_)},sortItem:b})})]},"content")}}}]);
//# sourceMappingURL=1302.6ae27b62.chunk.js.map