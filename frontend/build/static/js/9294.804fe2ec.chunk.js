"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1181,9294],{8668:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(2096),l=r(221),o=r(579);const a=function(e){let{id:t,title:r,code:a,products:d,activeCategory:n,onClick:c}=e;return(0,o.jsxs)("div",{className:"category-card "+(n?"active-category":""),onClick:()=>c(t),children:[(0,o.jsx)("h1",{className:"text-black-700 text-base leading-[1.5625rem]",children:r||(0,i.t)("Nomsiz kategoriya")}),(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,o.jsxs)("p",{className:"footer-text",children:[(0,i.t)("Kodi")," :"]}),(0,o.jsx)("span",{className:"block rounded-[3.125rem] bg-warning-500 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:a||0})]}),(0,o.jsxs)("div",{className:"flex gap-[0.3125rem] items-center",children:[(0,o.jsxs)("p",{className:"footer-text",children:[(0,i.t)("Maxsulot turlari")," :"]}),(0,o.jsx)("span",{className:"block rounded-[3.125rem] bg-success-400 py-[0.125rem] px-[0.625rem] text-xs leading-[0.875rem] text-white-900",children:d||0})]})]}),(0,o.jsx)("div",{className:"category-card-checkmark",children:(0,o.jsx)(l.KDk,{size:"1rem",className:"check-icon"})})]})}},2662:(e,t,r)=>{r.d(t,{A:()=>o});const i=(0,r(2104).Ay)("https://moyprays.uz/"),l=JSON.parse(localStorage.getItem("userData"));i.auth={token:l.token,market:l.market};const o=i},7152:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var i=r(5043),l=r(7630),o=r(2039),a=r(9456),d=r(827),n=r(4235),c=r(3536),s=r(8668),u=r(8054),p=r(221),m=r(9092),v=r(2662),g=r(3734),h=r(121),x=r(200),y=r(5618),b=r(3216),f=r(2216),j=r(6243);const N=(0,f.zD)("savedOrders/createTemporary",(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:t}=arguments.length>1?arguments[1]:void 0;try{const{data:t}=await j.A.post("/connections/createtemporary",e);return t}catch(r){return t(r)}})),k=(0,f.zD)("savedOrders/deleteSavedOrders",(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:t}=arguments.length>1?arguments[1]:void 0;try{const{data:t}=await j.A.post("/connections/deletetemporary",e);return t}catch(r){return t(r)}})),z=(0,f.zD)("savedOrders/getSavedOrders",(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:t}=arguments.length>1?arguments[1]:void 0;try{const{data:t}=await j.A.post("/connections/gettemporaries",e);return t}catch(r){return t(r)}}));(0,f.Z0)({name:"savedOrders",initialState:{savedOrders:[],getLoading:!0,deleteLoading:!1,deleteError:null,getError:null},extraReducers:{[N.pending]:e=>{e.getLoading=!0},[N.fulfilled]:(e,t)=>{let{payload:r}=t;(0,g.lY)(r.message,"success"),e.getLoading=!1},[N.rejected]:(e,t)=>{let{payload:r}=t;(0,g.lY)(r.message,"error"),e.getLoading=!1},[z.pending]:e=>{e.getLoading=!0},[z.fulfilled]:(e,t)=>{let{payload:r}=t;e.getLoading=!1,e.savedOrders=r},[z.rejected]:(e,t)=>{let{payload:r}=t;(0,g.lY)(r.message,"error"),e.getLoading=!1},[k.pending]:e=>{e.deleteLoading=!0},[k.fulfilled]:(e,t)=>{let{payload:r}=t;e.deleteLoading=!1,(0,g.lY)(r.message,"success")},[k.rejected]:(e,t)=>{let{payload:r}=t;(0,g.lY)(r,"error"),e.deleteLoading=!1,e.deleteError=r,e.deleteError=null}}}).reducer;var _=r(579);const w=function(){const{t:e}=(0,m.B)(["common"]),t=(0,a.wA)(),r=(0,b.zy)(),f=(0,b.Zp)(),{currencyType:j,currency:z}=(0,a.d4)((e=>e.currency)),{loading:w}=(0,a.d4)((e=>e.connections)),{market:S}=(0,a.d4)((e=>e.login)),{categoriesPartner:A,allProductsPartner:C}=(0,a.d4)((e=>e.registerIncomingOrders)),[P,D]=(0,i.useState)(null),[L,O]=(0,i.useState)(A),[$,E]=(0,i.useState)([]),[Y,B]=(0,i.useState)(null),[M,U]=(0,i.useState)(""),[I,K]=(0,i.useState)([]),[T,q]=(0,i.useState)(""),[W,V]=(0,i.useState)(!1),[Z,F]=(0,i.useState)(null),[J,Q]=(0,i.useState)(null),[R,G]=(0,i.useState)(null),[H,X]=(0,i.useState)(null),ee=e=>{Y===e?B(null):(B(e),U(""),O(A))},te=()=>{K([]),D(null)};return(0,i.useEffect)((()=>{let e=[],r=[];S&&P&&(v.A.emit("getPartnerProducts",{market:P.value,partner:S._id}),v.A.on("partnerCategories",(e=>{let{id:r,categories:i}=e;r===P.value&&(t((0,h.B1)(i)),O(i))})),v.A.on("setPartnerProducts",(i=>{let{id:l,products:o}=i;l===P.value&&(r=[...r,...(0,c.map)(o,(e=>({value:e._id,label:`(${e.total}) ${e.category.code}${e.productdata.code} - ${e.productdata.name}`})))],E(r),e.push(...o),t((0,h.Ql)(e)))})),v.A.on("error",(e=>{let{id:t,message:r}=e;t===S._id&&(0,g.lY)(r,"error")})))}),[S,t,P]),(0,i.useEffect)((()=>{if(Y){const e=(0,c.filter)(C,(e=>e.category._id===Y));E((0,c.map)(e,(e=>({value:e._id,label:`(${e.total}) ${e.category.code}${e.productdata.code} - ${e.productdata.name}`}))))}else E((0,c.map)(C,(e=>({value:e._id,label:`(${e.total}) ${e.category.code}${e.productdata.code} - ${e.productdata.name}`}))))}),[Y,C]),(0,i.useEffect)((()=>{const e=r.state;if(e&&e.order){var t,i,l,o,a,d;"send"===e.position&&X("incomingOrderSendProduct"),G(null===e||void 0===e?void 0:e.order),D({label:(null===e||void 0===e||null===(t=e.order)||void 0===t||null===(i=t.market)||void 0===i?void 0:i.name)+" - "+(null===e||void 0===e||null===(l=e.order)||void 0===l||null===(o=l.market)||void 0===o?void 0:o.inn),value:null===e||void 0===e||null===(a=e.order)||void 0===a||null===(d=a.market)||void 0===d?void 0:d._id});const r=(0,c.map)(e.order.products,(e=>{var t,r,i,l,o,a,d,n,c,s,u,p,m,v,g,h,x,y,b,f;const j=!(null===e||void 0===e||null===(t=e.pieces)||void 0===t||!t.send);return{market:null===e||void 0===e?void 0:e.market,product:{_id:null===e||void 0===e||null===(r=e.product)||void 0===r?void 0:r._id,code:null===e||void 0===e||null===(i=e.product)||void 0===i||null===(l=i.productdata)||void 0===l?void 0:l.code,name:null===e||void 0===e||null===(o=e.product)||void 0===o||null===(a=o.productdata)||void 0===a?void 0:a.name,barcode:null===e||void 0===e||null===(d=e.product)||void 0===d||null===(n=d.productdata)||void 0===n?void 0:n.barcode},productdata:null===(c=e.product)||void 0===c?void 0:c.productdata._id,category:null===(s=e.product)||void 0===s?void 0:s.category._id,totalprice:j?null===e||void 0===e?void 0:e.totalprice:(null===e||void 0===e||null===(u=e.pieces)||void 0===u?void 0:u.recived)*(null===e||void 0===e?void 0:e.unitprice),totalpriceuzs:j?null===e||void 0===e?void 0:e.totalpriceuzs:(null===e||void 0===e||null===(p=e.pieces)||void 0===p?void 0:p.recived)*(null===e||void 0===e?void 0:e.unitpriceuzs),pieces:{...null===e||void 0===e?void 0:e.pieces,send:j?null===e||void 0===e||null===(m=e.pieces)||void 0===m?void 0:m.send:null===e||void 0===e||null===(v=e.pieces)||void 0===v?void 0:v.recived},total:null===(g=e.product)||void 0===g?void 0:g.total,unitprice:null===e||void 0===e?void 0:e.unitprice,unitpriceuzs:null===e||void 0===e?void 0:e.unitpriceuzs,incomingprice:null===e||void 0===e||null===(h=e.product)||void 0===h||null===(x=h.price)||void 0===x?void 0:x.incomingprice,incomingpriceuzs:null===e||void 0===e||null===(y=e.product)||void 0===y||null===(b=y.price)||void 0===b?void 0:b.incomingpriceuzs,unit:null===e||void 0===e||null===(f=e.product)||void 0===f?void 0:f.unit}}));K(r)}window.history.replaceState({},document.title)}),[r.state]),(0,_.jsxs)("section",{className:"flex grow relative overflow-auto",children:[(0,_.jsx)(y.A,{body:T,isOpen:W,headerText:"complete"===T?"Buyurtmani yuborishni tasdiqlaysizmi?":"",toggleModal:()=>{V(!1),setTimeout((()=>{q("")}),500)},approveFunction:()=>{if(I.length>0){const e={products:I,orderId:null===R||void 0===R?void 0:R._id};t((0,h.LU)(e)).then((e=>{let{error:r,payload:i}=e;r||(R&&G(null),Q(i),setTimeout((()=>{q("checkOrder"),V(!0),te()}),500),Z&&(t(k({temporaryId:Z._id})),F(null)))}))}else(0,g.lY)(e("Maxsulotlar ro'yxati bo'sh!"),"warning")},order:J}),(0,_.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem] overflow-auto",children:[(0,_.jsxs)("div",{className:"mainPadding flex flex gap-[1.25rem]",children:[(0,_.jsx)(l.A,{select:!0,placeholder:"",value:P||"",label:e("Do`kon nomi"),onChange:e=>D(e),border:!0,disabled:!0}),(0,_.jsx)(l.A,{disabled:!P,select:!0,placeholder:e("misol: kompyuter"),value:"",label:e("Maxsulotlar"),onChange:t=>{if(t.barcode?(0,c.filter)(I,(e=>e.product.barcode===t.barcode)).length>0:(0,c.filter)(I,(e=>e.product._id===t.value)).length>0)(0,g.lY)(e("Maxsulot ro'yxatda mavjud !"),"error");else{const e=t.barcode?C.find((e=>e.productdata.barcode===t.barcode)):C.find((e=>e._id===t.value)),r={market:P.value,product:{_id:e._id,code:e.productdata.code,name:e.productdata.name,barcode:e.productdata.barcode},productdata:e.productdata._id,category:e.category._id,totalprice:e.price.sellingprice,totalpriceuzs:e.price.sellingpriceuzs,pieces:{revived:0,send:1,delivered:0,returned:0},total:e.total,unitprice:e.price.sellingprice,unitpriceuzs:e.price.sellingpriceuzs,incomingprice:e.price.incomingprice,incomingpriceuzs:e.price.incomingpriceuzs,unit:e.unit};K([...I,r])}},options:$})]}),(0,_.jsx)("div",{className:"tableContainerPadding",children:I.length?(0,_.jsx)(o.A,{page:H,data:I,headers:[{title:"\u2116"},{title:"Kodi"},{title:"Nomi"},{title:"Soni"},{title:"Buyurtma"},{title:"Yuborish",styles:"w-[15%]"},{title:"Narxi"},{title:"Jami"},{styles:"w-[10%]"},{}],currency:j,increment:e=>{const t=(0,c.map)(I,(t=>t.product._id===e?{...t,pieces:{...t.pieces,send:Number(t.pieces.send)+1},totalprice:(0,x.tE)((Number(t.pieces.send)+1)*t.unitprice),totalpriceuzs:(0,x.Df)((Number(t.pieces.send)+1)*t.unitpriceuzs)}:t));K(t)},decrement:e=>{const t=(0,c.map)(I,(t=>t.product._id===e?{...t,pieces:{...t.pieces,send:Number(t.pieces.send)>0?Number(t.pieces.send)-1:0},totalprice:(0,x.tE)((Number(t.pieces.send)>0?Number(t.pieces.send)-1:0)*t.unitprice),totalpriceuzs:(0,x.Df)((Number(t.pieces.send)>0?Number(t.pieces.send)-1:0)*t.unitpriceuzs)}:t));K(t)},handleDelete:e=>{I.splice(e,1),K([...I])},footer:"registersale",handleCountProduct:(e,t)=>{const r=Number(e.target.value),i=(0,c.map)(I,(e=>e.product._id===t?{...e,pieces:{...e.pieces,send:r},totalprice:(0,x.tE)(r*e.unitprice),totalpriceuzs:(0,x.Df)(r*e.unitpriceuzs)}:e));K(i)},handleUnitPrice:(e,t)=>{const r=Number(e.target.value),i="USD"===j?r:r/z,l="UZS"===j?r:r*z,o=(0,c.map)(I,(e=>e.product._id===t?{...e,unitprice:i,unitpriceuzs:l,totalprice:(0,x.tE)(e.pieces.send*i),totalpriceuzs:(0,x.Df)(e.pieces.send*l)}:e));K(o)}}):(0,_.jsx)(u.A,{text:e("Buyurtmaga mahsulotlar qo'shilmagan!...")})})]}),(0,_.jsxs)("div",{className:"register-selling-right min-w-[20.25rem] bg-white-400 backdrop-blur-[3.125rem] rounded-[0.25rem] flex flex-col gap-[1.25rem]",children:[(0,_.jsxs)("div",{className:"flex flex-col grow gap-[1.25rem]",children:[(0,_.jsx)(d.A,{placeholder:e("kategoriyani qidirish..."),value:M,onChange:e=>{const t=e.target.value;U(t);const r=t.replace(/\s+/g," ").trim(),i=(0,c.filter)(A,(e=>e.name&&e.name.toLowerCase().includes(r)||e.code.includes(r)));O(""!==t?i:A)},onKeyUp:()=>{}}),(0,_.jsx)("div",{className:"grow relative overflow-auto",children:(0,_.jsx)("div",{className:"cards-container absolute left-0 right-[0.125rem] top-0 bottom-0",children:w?(0,_.jsx)("div",{className:"tableContainerPadding",children:(0,_.jsx)(n.A,{})}):L.length>0?(0,c.map)(L,(e=>(0,_.jsx)(s.A,{id:e._id,activeCategory:e._id===Y,title:e.name,code:e.code,products:e.products.length,onClick:ee},e._id))):(0,_.jsx)(u.A,{text:e("Kategoriya mavjud emas")})})})]}),(0,_.jsxs)("div",{className:"flex gap-[0.625rem]",children:[(0,_.jsx)("button",{type:"button",className:"register-selling-right-accept-btn",onClick:()=>{I.length?(V(!0),q("complete")):z?(0,g.$5)():(0,g.QC)()},children:e("Buyurtmani yuborish")}),(0,_.jsx)("button",{type:"button",onClick:()=>{if(I.length>0){const e=I.reduce(((e,t)=>(0,x.tE)(e+t.totalprice)),0),r=I.reduce(((e,t)=>(0,x.Df)(e+t.totalpriceuzs)),0);t(N({temporary:{partner:P,tableProducts:I,totalPrice:e,totalPriceUzs:r}})).then((e=>{let{error:t}=e;t||(te(),f("/dukonlar/buyurtma_berish/saqlanganlar"))})),Z&&(t(k({temporaryId:Z._id})),F(null))}else(0,g.lY)(e("Maxsulotlar ro'yxati bo'sh!"),"warning")},className:"register-selling-right-deny-btn",children:(0,_.jsx)(p.WiF,{size:"1.5rem"})})]})]})]})}}}]);
//# sourceMappingURL=9294.804fe2ec.chunk.js.map