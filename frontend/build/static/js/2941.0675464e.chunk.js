"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2941],{3307:(e,t,l)=>{l.d(t,{A:()=>s});l(5043);var a=l(221),n=l(579);const s=e=>{let{text:t,onClick:l}=e;return(0,n.jsxs)("button",{onClick:l,className:"bg-primary-800 flex items-center gap-[0.3125rem] justify-center p-[10px] text-white-900 rounded-[0.5rem] shadow-[0_5px_15px_rgba(0,0,0,0.15)] transition-all ease-in-out duration-200 active:shadow-none hover:bg-primary-900",children:[(0,n.jsx)(a.zo4,{className:"text-white-900",size:"1.125rem"})," ",t&&(0,n.jsx)("span",{className:"text-sm leading-[1.125rem]",children:t})]})}},2662:(e,t,l)=>{l.d(t,{A:()=>s});const a=(0,l(2104).Ay)("https://moyprays.uz/"),n=JSON.parse(localStorage.getItem("userData"));a.auth={token:n.token,market:n.market};const s=a},2941:(e,t,l)=>{l.r(t),l.d(t,{default:()=>P});var a=l(5043),n=l(3237),s=(l(4964),l(2039)),i=l(7424),o=l(9456),d=l(4235),r=l(8054),u=l(1605),c=l(1154),v=l(3054),m=l(6694),p=l(5618),h=l(9092),g=l(3536),f=l(200),y=l(3734),S=l(2662),x=l(7160),w=(l(8069),l(5369)),z=l(3297),D=l(6752),b=l(7919),j=l(3307),k=l(579);const P=e=>{let{id:t}=e;const{t:l}=(0,h.B)(["common"]),P=[{title:"\u2116"},{title:l("Sana"),filter:"createdAt"},{title:l("ID"),filter:"id"},{title:l("Mijoz")},{title:l("Jami")},{title:l("Chegirma")},{title:l("Qarz")},{title:l("Izoh")},{title:"",styles:"w-[7rem]"}],C=(0,o.wA)(),{currencyType:I}=(0,o.d4)((e=>e.currency)),{user:N,market:E}=(0,o.d4)((e=>e.login)),{totalpayment:A}=(0,o.d4)((e=>e.reports)),[B,O]=(0,a.useState)(!1),{sellings:q,searchedSellings:L,getSellingsLoading:_,total:W,totalSearched:Y}=(0,o.d4)((e=>e.sellings)),{expenses:U}=(0,o.d4)((e=>e.expense)),[J,M]=(0,a.useState)(""),[Q,T]=(0,a.useState)(q),[Z,$]=(0,a.useState)(q),[F,R]=(0,a.useState)(W),[H,X]=(0,a.useState)(L),[G,K]=(0,a.useState)("10"),[V,ee]=(0,a.useState)(0),[te,le]=(0,a.useState)({id:"",client:"",product:""}),[ae,ne]=(0,a.useState)({filter:"",sort:"",count:0}),[se,ie]=(0,a.useState)(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),[oe,de]=(0,a.useState)(new Date),[re,ue]=(0,a.useState)(null),[ce,ve]=(0,a.useState)(!1),[me,pe]=(0,a.useState)(null),[he,ge]=(0,a.useState)([]),[fe,ye]=(0,a.useState)(""),Se=e=>{let{value:t}=e;K(t),ee(0)},xe=(0,a.useMemo)((()=>({cash:{uzs:U.filter((e=>"cash"===e.type)).reduce(((e,t)=>{let{sumuzs:l}=t;return e+l}),0),usd:U.filter((e=>"cash"===e.type)).reduce(((e,t)=>{let{sum:l}=t;return e+l}),0)},card:{uzs:U.filter((e=>"card"===e.type)).reduce(((e,t)=>{let{sumuzs:l}=t;return e+l}),0),usd:U.filter((e=>"card"===e.type)).reduce(((e,t)=>{let{sum:l}=t;return e+l}),0)},transfer:{uzs:U.filter((e=>"transfer"===e.type)).reduce(((e,t)=>{let{sumuzs:l}=t;return e+l}),0),usd:U.filter((e=>"transfer"===e.type)).reduce(((e,t)=>{let{sum:l}=t;return e+l}),0)}})),[U]),we=e=>{const t=e.target.value,l=t.replace(/\s+/g," ").trim();if(m.C.test(t)&&le({...te,id:t}),(H.length>0||Y>0)&&C((0,v.ix)()),""===l)T(q),R(W);else{const e=(0,g.filter)(q,(e=>e.id.includes(l)));T(e),R(e.length)}},ze=e=>{const t=e.target.value,l=t.toLowerCase().replace(/\s+/g," ").trim();if(le({...te,client:t}),(H.length>0||Y>0)&&C((0,v.ix)()),""===l)T(q),R(W);else{const e=(0,g.filter)(q,(e=>{var t,a;return(null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.name.toLowerCase().includes(l))||(null===e||void 0===e||null===(a=e.packman)||void 0===a?void 0:a.name.toLowerCase().includes(l))}));T(e),R(e.length)}},De=e=>{if("Enter"===e.key){ee(0);const e={filialId:t,currentPage:V,countPage:G,startDate:se.toISOString(),endDate:oe.toISOString(),search:te};C((0,v.d2)(e))}},be=e=>{M("allChecks"),ue(e),ve(!0)},je=e=>{M("addPlus"),ve(!0),pe(e)},[ke,Pe]=(0,a.useState)(""),[Ce,Ie]=(0,a.useState)(null),Ne=(e,t)=>{Pe(t),Ie(e._id),M("changeComment"),ve(!0)};(0,a.useEffect)((()=>{console.log(q),T(q),$(q)}),[q]),(0,a.useEffect)((()=>{X(L)}),[L]),(0,a.useEffect)((()=>{R(W)}),[W]),(0,a.useEffect)((()=>{const e={filialId:t,currentPage:V,countPage:G,startDate:se.toISOString(),endDate:oe.toISOString(),search:{id:"",client:""}};C((0,v.WL)(e))}),[V,G,se,oe,C,t]),(0,a.useEffect)((()=>{const e={startDate:se,endDate:oe,search:te};C((0,v.ah)(e))}),[C,se,oe,te]);const Ee=e=>{if(e===ae.filter)switch(ae.count){case 1:ne({filter:e,sort:"1",count:2}),(0,f.Yc)(Q,T,e,1,Z);break;case 2:ne({filter:e,sort:"",count:0}),(0,f.Yc)(Q,T,e,"",Z);break;default:ne({filter:e,sort:"-1",count:1}),(0,f.Yc)(Q,T,e,-1,Z)}else ne({filter:e,sort:"-1",count:1}),(0,f.Yc)(Q,T,e,-1,Z)},[Ae,Be]=(0,a.useState)(window.innerWidth<=768);(0,a.useEffect)((()=>{const e=()=>{Be(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((()=>{let e=[],t=[{label:"Xammasi",value:""}];E&&S.A.emit("getProductsOfCount",{market:E._id}),E&&S.A.on("getProductsOfCount",(l=>{let{id:a,products:n}=l;a===E._id&&(t=[...t,...(0,g.map)(n,(e=>({value:e._id,label:e.productdata.name})))],ge(t),e.push(...n),C((0,x.UC)(e)))})),E&&S.A.on("error",(e=>{let{id:t,message:l}=e;t===E._id&&(0,y.lY)(l,"error")}))}),[E,C]);const Oe=e=>{ye(e);const l={filialId:t,currentPage:V,countPage:G,startDate:se.toISOString(),endDate:oe.toISOString(),search:{id:"",client:"",product:e.label}};C((0,v.d2)(l))};return(0,k.jsxs)(u.P.section,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.8,ease:[.04,.62,.23,.98]},children:[(0,k.jsx)(p.A,{printedSelling:re,currency:I,body:J,isOpen:ce,toggleModal:()=>{ve(!ce),ue(null);const e={filialId:t,currentPage:V,countPage:G,startDate:se.toISOString(),endDate:oe.toISOString(),search:{id:"",client:"",product:null===fe||void 0===fe?void 0:fe.label}};C((0,v.WL)(e))},approveFunction:e=>{C((0,v.d5)({...e,saleconnectorid:me})).then((()=>{const e={filialId:t,currentPage:V,countPage:G,startDate:se.toISOString(),endDate:oe.toISOString(),search:{id:"",client:""}};C((0,v.WL)(e))})),ve(!1)},commentText:ke,dailyid:Ce,isSalesList:!0}),(0,k.jsxs)("div",{className:"pagination lg:m-3 flex lg:justify-start items-center justify-evenly",children:[(0,k.jsx)("span",{className:"ms-[-10px] lg:ms-3"}),(0,k.jsx)(n.A,{onClick:()=>{let e="Sotuvlar"-(new Date).toLocaleDateString();const t=["\u2116",l("ID"),l("Mijoz"),l("Jami UZS"),l("Jami USD"),l("Chegirma UZS"),l("Chegirma USD"),l("Qarz UZS"),l("Qarz USD")];if((null===Q||void 0===Q?void 0:Q.length)>0){const l=(0,g.map)(Q,((e,t)=>{var l,a,n,s,i,o;return{nth:t+1,id:(null===e||void 0===e?void 0:e.id)||"",client:(null===e||void 0===e||null===(l=e.client)||void 0===l?void 0:l.name)||(null===e||void 0===e||null===(a=e.packman)||void 0===a?void 0:a.name),alluzs:(null===e||void 0===e||null===(n=e.products[0])||void 0===n?void 0:n.totalpriceuzs)||"",allusd:(null===e||void 0===e||null===(s=e.products[0])||void 0===s?void 0:s.totalprice)||"",discount:e.discounts.length>0?e.discounts.map((e=>e)):0,discountusd:e.discounts.length>0?e.discounts.map((e=>e)):0,debd:(null===e||void 0===e||null===(i=e.products[0])||void 0===i?void 0:i.totalpriceuzs)-(null===e||void 0===e||null===(o=e.payments[0])||void 0===o?void 0:o.paymentuzs)-(null===e||void 0===e?void 0:e.discounts.length)>0?e.discounts.map((e=>e.discount)):0,debdusd:e.products[0].totalprice-e.payments[0].payment-e.discounts.length>0?e.discounts.map((e=>e.discount)):0}}));(0,f.m1)(l,e,t)}else(0,y.lY)("Jadvalda ma'lumot mavjud emas !","warning")}}),Ae&&(0,k.jsxs)("button",{onClick:()=>O(!0),className:"hover:bg-blue-200  bg-blue-400 focus-visible:outline-none w-[90px] h-[33px]  createElement",children:[(0,k.jsx)(w.YsJ,{})," ",l("izlash")]}),(0,k.jsx)("div",{className:"ml-3 px-4 py-2 flex justify-end",children:(0,k.jsx)(j.A,{text:`${l("Savdo hisoboti")}`,onClick:async e=>{try{var t,l,a,n,s,i,o,d,r,u,c,m,p,h,g,f,y,S,x,w,z,j,k,P,I,N,E,B,O,q;let e={startDate:new Date(se),endDate:new Date(oe),search:{client:"",id:"",product:""}},L={startDate:new Date(se).toISOString(),endDate:new Date(oe)};const[{saleconnectors:_},{income:W,debts:Y,discounts:U},{totalpieces:J},{totalpieces:Q,totalprice:T,totalpriceuzs:Z,producttypes:$}]=await Promise.all([await C((0,v.ah)(e)).unwrap(),await C((0,D.RI)(L)).unwrap(),await C((0,D.U7)(L)).unwrap(),await C((0,b.d$)()).unwrap(),await C((0,D.Hj)(e)).unwrap(),await C((0,D.Qj)(e)).unwrap()]);ue({boshsana:se,tugashsana:oe,sotuvlarsoni:_.length,tushumlar:{naqt:{sum:null===A||void 0===A||null===(t=A.payment)||void 0===t?void 0:t.cashuzs,dollar:null===A||void 0===A||null===(l=A.payment)||void 0===l?void 0:l.cash},plastik:{sum:null===A||void 0===A||null===(a=A.payment)||void 0===a?void 0:a.carduzs,dollar:null===A||void 0===A||null===(n=A.payment)||void 0===n?void 0:n.card},utkazma:{sum:null===A||void 0===A||null===(s=A.payment)||void 0===s?void 0:s.transferuzs,dollar:null===A||void 0===A||null===(i=A.payment)||void 0===i?void 0:i.transfer}},qaytarilganlar:{naqt:{sum:null===A||void 0===A||null===(o=A.back)||void 0===o?void 0:o.cashuzs,dollar:null===A||void 0===A||null===(d=A.back)||void 0===d?void 0:d.cash},plastik:{sum:null===A||void 0===A||null===(r=A.back)||void 0===r?void 0:r.carduzs,dollar:null===A||void 0===A||null===(u=A.back)||void 0===u?void 0:u.card},utkazma:{sum:null===A||void 0===A||null===(c=A.back)||void 0===c?void 0:c.transferuzs,dollar:null===A||void 0===A||null===(m=A.back)||void 0===m?void 0:m.transfer}},xarajatlar:{naqt:{sum:null===xe||void 0===xe||null===(p=xe.cash)||void 0===p?void 0:p.uzs,dollar:null===xe||void 0===xe||null===(h=xe.cash)||void 0===h?void 0:h.usd},plastik:{sum:null===xe||void 0===xe||null===(g=xe.card)||void 0===g?void 0:g.uzs,dollar:null===xe||void 0===xe||null===(f=xe.card)||void 0===f?void 0:f.usd},utkazma:{sum:null===xe||void 0===xe||null===(y=xe.transfer)||void 0===y?void 0:y.uzs,dollar:null===xe||void 0===xe||null===(S=xe.transfer)||void 0===S?void 0:S.usd}},foyda:{sum:null===W||void 0===W?void 0:W.incomeuzs,dollar:null===W||void 0===W?void 0:W.income},qarzlar:{sum:null===Y||void 0===Y?void 0:Y.debtsuzs,dollar:null===Y||void 0===Y?void 0:Y.debts},chegirmalar:{sum:null===U||void 0===U?void 0:U.discountsuzs,dollar:null===U||void 0===U?void 0:U.discounts},kassaqoldiq:{naqt:{sum:(null===A||void 0===A||null===(x=A.result)||void 0===x?void 0:x.cashuzs)-(null===xe||void 0===xe||null===(w=xe.cash)||void 0===w?void 0:w.uzs),dollar:(null===A||void 0===A||null===(z=A.result)||void 0===z?void 0:z.cash)-(null===xe||void 0===xe||null===(j=xe.cash)||void 0===j?void 0:j.usd)},plastik:{sum:(null===A||void 0===A||null===(k=A.result)||void 0===k?void 0:k.carduzs)-(null===xe||void 0===xe||null===(P=xe.card)||void 0===P?void 0:P.uzs),dollar:(null===A||void 0===A||null===(I=A.result)||void 0===I?void 0:I.card)-(null===xe||void 0===xe||null===(N=xe.card)||void 0===N?void 0:N.usd)},utkazma:{sum:(null===A||void 0===A||null===(E=A.result)||void 0===E?void 0:E.transferuzs)-(null===xe||void 0===xe||null===(B=xe.transfer)||void 0===B?void 0:B.uzs),dollar:(null===A||void 0===A||null===(O=A.result)||void 0===O?void 0:O.transfer)-(null===xe||void 0===xe||null===(q=xe.transfer)||void 0===q?void 0:q.usd)}},sotilganmaxsulotlarsoni:J,qolganmaxsulotlarsoni:$,qolganmaxsulotlarumumiysoni:Q,qolganmaxsulotlarqiymati:{sum:Z,dollar:T}}),M("dailySaleCheck"),ve(!0)}catch(L){return console.error(L)}}})})]}),Ae?B&&(0,k.jsxs)("div",{className:"absolute lg:p-[50px] w-[100vw]  h-[100vh]  flex justify-evenly flex-wrap   top-0\tleft-0 z-50 bg-[white]\t",children:[(0,k.jsx)(c.hvQ,{onClick:()=>O(!1),className:" absolute right-[20px]  top-[20px]  text-4xl cursor-pointer"}),(0,k.jsxs)("div",{className:"mt-[100px]",children:[(0,k.jsx)(i.A,{filterBy:["total","startDate","endDate","id","clientName","product_name"],filterByTotal:Se,startDate:se,setStartDate:ie,endDate:oe,setEndDate:de,searchById:te.id,searchByClientName:te.client,filterByClientName:ze,filterById:we,filterByClientNameWhenPressEnter:De,filterByIdWhenPressEnter:De,filteredProducts:he,handleChangeSelectedProduct:Oe,selectedProduct:fe}),(0,k.jsx)("div",{className:"flex justify-center",children:(0,k.jsxs)("button",{onClick:()=>O(!1),className:"hover:bg-blue-200  bg-blue-400 focus-visible:outline-none w-[150px] h-[40px]  createElement",children:[(0,k.jsx)(w.YsJ,{})," ",l("izlash")]})})]})]}):(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsx)(i.A,{filterBy:["total","startDate","endDate","id","clientName","product_name"],filterByTotal:Se,startDate:se,setStartDate:ie,endDate:oe,setEndDate:de,searchById:te.id,searchByClientName:te.client,filterByClientName:ze,filterById:we,filterByClientNameWhenPressEnter:De,filterByIdWhenPressEnter:De,filteredProducts:he,handleChangeSelectedProduct:Oe,selectedProduct:fe})}),(0,k.jsx)("div",{className:"lg:tableContainerPadding",children:_?(0,k.jsx)(d.A,{}):0===Q.length&&0===H.length?(0,k.jsx)(r.A,{text:`${l("Ro'yxat mavjud emas")}`}):Ae?(0,k.jsx)(z.A,{data:H.length>0?H:Q,currentPage:V,currency:I,countPage:G,page:"saleslist",headers:P,Print:be,addPlus:je,Sort:Ee,sortItem:ae,sellers:"Seller"===(null===N||void 0===N?void 0:N.type),editComment:Ne}):(0,k.jsx)(s.A,{data:H.length>0?H:Q,currentPage:V,currency:I,countPage:G,page:"saleslist",headers:P,Print:be,addPlus:je,Sort:Ee,sortItem:ae,sellers:"Seller"===(null===N||void 0===N?void 0:N.type),editComment:Ne})})]},"content")}}}]);
//# sourceMappingURL=2941.0675464e.chunk.js.map